<!DOCTYPE html>
<head>
    <title>Installing Windows 10 to SD Card</title>
<style>
ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
    overflow: hidden;
    background-color: #333;
}

li {
    float: left;
}

li a {
    display: block;
    color: white;
    text-align: center;
    padding: 14px 16px;
    text-decoration: none;
}

li a:hover {
    background-color: #111;
}
    
.active {
    background-color: #4CAF50;
}
    
</style>
    <style type="text/css">
        code {
            background-color: #eee;
            color: black;
            padding: 5px;
            display: block;
        }
    </style>
</head>
<body>

<ul>
  <li><a href="index.html">Home</a></li>
  <li><a class="active" href="install.html">Installation</a></li>
  <li><a href="helpus.html">Help Us!</a></li>
  <li><a href="about.html">About</a></li>
</ul>
    
    <p>Materials needed:</p>
    <p>Windows 10, Build 1703 or later</p>
    <p><a href="https://github.com/andreiw/RaspberryPiPkg/">Tiano 64-Bit UEFI Loader for RPi3 (WoA Debug buils only)</a></p>
    <p><a href="https://www.partitionwizard.com/free-partition-manager.html">MiniTool Partition Editor</a></p>
    <p><kbd>dism</kbd>, <kbd>bcdedit</kbd>, and <kbd>bcdboot</kbd></p>
    <br />
    <br />

<h1>WoAPi Downloads and Installation</h1>

<h2>Step 1: Download the ISO compiler</h2>
<p>WoA for Pi can be downloaded using UUP ADGuard which can be found <a href="https://uup.rg-adguard.net/">here</a> with the following settings:</p>
<code>Type: Windows (Insider Edition)<br/>
Version: Windows 10 Insider Preview 17134.1 (rs4_release) [arm64]<br/>
Language: Chose your Language of Preference<br/>
Edition: Windows 10 Professional<br/>
Type of Download: Download ISO compiler in OneClick! (unZIP -> RUN creatingISO.cmd)</code>
<p>Then click the link to the right of the selection menus that says <kbd>creatingISO_17134.1_language_arm64_Professional.zip</kbd></p>

<h2>Step 2: Starting the Compiler</h2>
<p>Unzip the archive that was downloaded and go to the directory it was extracted to. Run the file named<br/> <code>creatingISO.cmd</code></p>
<p>It will start downloading files for compilation of an ISO. Depending on your download speed, and the speed of your computer, this may take anywhere from half an hour to two hours. Now is a great time to drink a cup of coffee or watch a movie</p>

<h2>Step 3: Extracting the WIM</h2>
<p>Open the ISO that was compiled from the compiler in WinRAR or 7Zip and go to the <kbd>sources</kbd> directory. Scroll down until you find a file named <kbd>install.wim</kbd> (this is not to be confused with <kbd>boot.wim</kbd>).</p>
<p>Extract that file to a folder of your chosing. We recommend putting the WIM and all other files in their own folder to keep everything simple.</p>

<h2>Step 4: Installing drivers</h2>
<p>Here comes the hard part...</p>
<p>There are a series of commands used to do this.</p>
<p>First, open the Command Prompt as administrator. This is important as the commands will not work if you are using the Command Prompt as a normal user.</p>
<p>After that, navigate the the directory that holds the file named <kbd>install.wim</kbd> and download the files located on <a href="https://github.com/andreiw/rpi3winstuff">this</a> GitHub repository.</p>
    <p>Extract the files to the same folder and copy the folder named <kbd>driver_prebuilts</kbd> that is inside the zip you just extracted. Your working folder should look something like this (I will explain "m" soon):</p>
<img src="installation-img-1.png" alt="Working Folder">
<p>Now that you have the drivers (the drivers are for SD and USB), we have to actually install the drivers. First, make a directory called "m" (to keep it short and simple). After that, go to the Command Prompt you just opened and type in the following case sensitive command:</p>
<code>dism /mount-image /imagefile:install.wim /Index:1 /MountDir:m</code>
<p>Depending on the speed of your computer and hard disk, this may take from 10 seconds to 10 minutes. Eventually, when it finishes, install the drivers with the following command:</p>
<code>dism /image:m /add-driver /driver:driver_prebuilts /recurse /forceunsigned</code>
<p>/forceunsigned tells dism to apply the drivers, even though they have not been signed by an official business.</p>
<p>This process should not take long, usualy under 30 seconds.</p>
<p>Then, run this command to save the modifications to the install.wim file:</p>
<code>dism /unmount-wim /mountdir:m /commit</code>
<p>This will take a little while, 30 minutes at most, but this isn't even the longest part (of the WIM modification process) which is coming up next.</p>
<p>When this process finishes, it's time to actually apply the image. But first, we must format your SD card properly...</p>

<h2>Step 5: Formatting the SD card</h2>
<p>First, launch MiniTool. Find your SD card (it will have a box to the side of the drive saying "SD") and delete every partition on it. Before you hit apply, be sure to back up any information you do not want to lose on it. When you have done that, hit apply.</p>
<p>After that, right click the gray bar and press "create new partition". Chose Fat32 and make the size of the partition small, like 128MBs.</p>
<p>Then, create another partition that is formated with NTFS and make it fill the rest of the space of the SD card. It should look something similar to this:</p>
<img src="installation-img-2.png" alt="Partitions">
<p>If it does (except for the "used" part because that SD card is actually having Windows 10 installed as we type this), hit the Apply button</p>
<p>Install the Tiano Core 64-bit which can be found <a href="https://drive.google.com/open?id=1J876koTjyc4LnJQGPL-wLqRzGW1bnSqj">here by copying the files in the DEBUG folder to the Fat32 partition.</a> This is a prebuilt version provided by the SparrOS Developer Team.</p>

<h2>Step 6: Applying the image</h2>
<p>Depending on the speed of your SD card writer, this may take from 20 minutes to 2 hours.</p>
<p>First, find out which letter the NTFS partition is assigned to. This is very important as using a different letter may overwrite information on another drive!</p>
<p>After figuring that out, use the following command to apply the WIM image to the partition:</p>
    <code>dism /apply-image /imagefile:install.wim /index:1 /applydir:[drive letter here]</code>
<p>When this finishes, go to step 7.</p>

<h2>Step 7: Copying the EFI file and making Windows 10 bootable</h2>


<h1>Why didn't we just upload the WIM?</h1>
<p>The reason why we didn't just upload the WIM to download is because that would be concidered piracy. This was the original plan but at the same time, we would rather not end the day with a lawsuit. We are sorry for any inconvenience this may cause!</p>

</body>
</html>
